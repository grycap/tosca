tosca_definitions_version: tosca_simple_yaml_1_0

imports:
  - grycap_custom_types: https://raw.githubusercontent.com/grycap/tosca/main/custom_types.yaml

description: Download a list of Datasets in a Kubernetes PVC

metadata:
  template_version: "1.0.0"
  template_name: Download list of datasets in K8s
  display_name: Download list of datasets in K8s
  icon: images/dataset.png
  parents:
    - kubernetes.yaml
  tabs:
    Download Dataset:
      - dataset_ids
      - dest
      - owner
      - pvc_name
      - pvc_namespace

topology_template:

  inputs:

    dataset_ids:
      type: list
      entry_schema:
        type: string
      description: List of URLs or DOIs of the data to Download.
      default: []

    dest:
      type: string
      description: Local path where the datasets will be downloaded
      default: '/data'

    owner:
      type: string
      description: Change the ownership of the directory where the datasets should be saved.
      default: ''

    pvc_name:
      type: string
      description: Name of the PVC where the dataset will be downloaded (only for Kubernetes deployments)
      default: ''

    pvc_namespace:
      type: string
      description: Namespace of the PVC where the dataset will be downloaded (only for Kubernetes deployments)
      default: ''

  node_templates:

    # A Dataset downloaded directly to the local filesystem
    my_dataset_list:
      type: tosca.nodes.eosc.DatasetList
      properties:
        dataset_ids: { get_input: dataset_ids }
        dest: { get_input: dest }
        owner: { get_input: owner }
        pvc_name: { get_input: pvc_name }
        pvc_namespace: { get_input: pvc_namespace }
      requirements:
        - host: front
